<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Lecture 5</title>
    <meta charset="utf-8" />
    <meta name="author" content="Hu Chuan-Peng (PhD)" />
    <meta name="date" content="2024-03-27" />
    <script src="libs/header-attrs-2.20/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.27/datatables.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="css/zh-CN.css" type="text/css" />
    <link rel="stylesheet" href="css/Custumed_Style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Lecture 5
]
.subtitle[
## Data cleaning
]
.author[
### Hu Chuan-Peng (PhD)
]
.institute[
### Nanjing Normal University
]
.date[
### 2024-03-27
]

---

class: center, middle
&lt;span style="font-size: 60px;"&gt;第五讲&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 60px;"&gt;数据清理（上）&lt;/span&gt; &lt;br&gt;
&lt;br&gt;
&lt;span style="font-size: 30px;"&gt;胡传鹏&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 30px;"&gt;2024-03-25&lt;/span&gt; &lt;br&gt;

---
&lt;br&gt;
&lt;br&gt;
# &lt;h1 lang="zh-CN"&gt;回顾&lt;/h1&gt;
# &lt;h2 lang="zh-CN"&gt;&amp;emsp;5.1 数据导入&lt;/h2&gt;
# &lt;h2 lang="zh-CN"&gt;&amp;emsp;5.2 赋值&lt;/h2&gt;
# &lt;h2 lang="zh-CN"&gt;&amp;emsp;5.3 数据类型&lt;/h2&gt;
# &lt;h2 lang="zh-CN"&gt;&amp;emsp;5.4 数据结构&lt;/h2&gt;
&lt;br&gt;
&lt;br&gt;
# &lt;h1 lang="zh-CN"&gt;本节课内容&lt;/h1&gt;
# &lt;h2 lang="zh-CN"&gt;&amp;emsp;5.5 对数据的操纵&lt;/h2&gt;
# &lt;h2 lang="zh-CN"&gt;&amp;emsp;5.6 数据类型的判断与转换&lt;/h2&gt;
# &lt;h2 lang="zh-CN"&gt;&amp;emsp;5.7 函数&lt;/h2&gt;

---
# &lt;h1 lang="zh-CN"&gt;5.1 数据导入&lt;/h1&gt;
# &lt;font size = 5.5&gt; 问卷数据：Human Penguin Project &lt;/font&gt; 
- # &lt;font size = 5.5&gt; 绝对路径:对文件或目录位置的完整描述，从根目录开始 &lt;/font&gt;

```r
paste(getwd(),"/data/penguin/penguin_rawdata.csv",sep = "")
```

```
## [1] "D:/Study/NNU/YAN2/2/R/R4Psy/data/penguin/penguin_rawdata.csv"
```
- # &lt;font size = 5.5&gt; 相对路径:对文件或目录位置的部分描述，从当前工作目录开始。 &lt;/font&gt;
"data/penguin/penguin_rawdata.csv"
- # &lt;font size = 5.5&gt; 工作目录 &lt;/font&gt;

```r
getwd()#获取工作目录
```

```
## [1] "D:/Study/NNU/YAN2/2/R/R4Psy"
```
--
- # &lt;font size = 5.5&gt;绝对路径=工作目录+相对路径&lt;/font&gt;
- # &lt;font size = 5.5&gt;推荐使用相对路径&lt;/font&gt;
---

```r
#下载、导入所需R包
if (!requireNamespace('pacman', quietly = TRUE)) {
    install.packages('pacman')
}
pacman::p_load(bruceR,tidyverse)
```


```r
#读取数据
penguin_data = bruceR::import(here::here('data', 'penguin', 'penguin_rawdata.csv'))
```
--
&lt;br&gt;&lt;img src="./pic_new/chp5/env.png" width="100%" style="display: block; margin-left: auto; margin-right: auto;"&gt;
---
# &lt;h1 lang="zh-CN"&gt;5.2 赋值与变量&lt;/h1&gt;

在R中，我们可以使用赋值操作符“&lt;-”或“=”给对象赋值。&lt;br&gt;
比如：

```r
object &lt;- 10
object
```

```
## [1] 10
```
我们给对象“object”赋值为10。&lt;br&gt;
赋值后可以对“object”进行操作，比如：&lt;br&gt;

```r
object + 2
```

```
## [1] 12
```
但注意此时的“object”本身并未发生改变。

```r
object
```

```
## [1] 10
```
---
# &lt;h1 lang="zh-CN"&gt;5.2 赋值与变量&lt;/h1&gt;
![error1](pic_new/chp5/error1.png)
&lt;font size=5&gt; 为什么会报错？&lt;br&gt;
&lt;br&gt;
--
&lt;font size=5&gt; R中变量名是区分大小写的&lt;br&gt;
--
&lt;br&gt;
![error2](pic_new/chp5/error2.png)
&lt;br&gt;
&lt;br&gt;
&lt;font size=5&gt;  变量名可以由字母、数字、_和.组成。并且变量名的第一个字符不能为数字或者特殊符号，比如 +, -, *, /, ^, !, @, &amp;。&lt;/font&gt; &lt;br&gt;  
&lt;br&gt;
---
# &lt;h1 lang="zh-CN"&gt;5.2 赋值与变量&lt;/h1&gt;
&lt;font size="5"&gt;
&lt;br&gt;
&lt;br&gt;
tips：&lt;br&gt;
&lt;br&gt;
&amp;emsp;&amp;emsp;变量名可以使用中文，但不推荐，可能出现这样的乱码：&lt;br&gt;
&amp;emsp;&amp;emsp;鍙︿竴涓▼搴忔鍦ㄤ娇鐢ㄦ鏂囦欢锛岃繘绋嬫棤娉曡闂��。&lt;br&gt;
&lt;br&gt;
&amp;emsp;&amp;emsp;命名对象最好有不错的可读性，比如“age”就要比“x”更易读。
&lt;/font&gt;

---
# &lt;h1 lang="zh-CN"&gt;5.3 基本数据类型&lt;/h1&gt;
&lt;font size=5&gt; 
- numeric（数值型），又分为 integer（整数型）和 double（浮点型）&lt;/h3&gt;
- logical（逻辑型），只有 TRUE 和 FALSE，或 T 和 F&lt;/h3&gt;
- character（字符型），引号括起来的若干字符&lt;/h3&gt;
- complex（复数类型），复数&lt;/h3&gt;
- raw（原始型），用于存储原始字节数据&lt;/h3&gt;

```r
object &lt;- 10
class(object)#查看数据类型
```

```
## [1] "numeric"
```

```r
a &lt;- 3.14
class(a)
```

```
## [1] "numeric"
```

---
# &lt;h1 lang="zh-CN"&gt;5.3 基本数据类型&lt;/h1&gt;

```r
b &lt;- T
class(b)
```

```
## [1] "logical"
```

```r
c &lt;- 'R4Psy'
class(c)
```

```
## [1] "character"
```

```r
d &lt;- 3+4i
class(d)
```

```
## [1] "complex"
```

```r
e &lt;- charToRaw('hello')
class(e)
```

```
## [1] "raw"
```

---
# &lt;h1 lang="zh-CN"&gt;5.4 数据结构&lt;/h1&gt;
数据结构是为了便于存储相同或不同类型的数据而设计的数据容器。&lt;br&gt;
常用数据结构&lt;br&gt;
&amp;emsp;存放同类型数据：向量(Vector),矩阵(Matrix),多维数组(Array)&lt;br&gt;
&amp;emsp;存放不同类型数据：列表(List)、数据框(Data Frame)&lt;br&gt;
&amp;emsp;因子(Factor)&lt;br&gt;
![data structure](https://devopedia.org/images/article/46/9213.1526125966.png)
---
# &lt;h1 lang="zh-CN"&gt;5.4 数据结构&lt;/h1&gt;

```r
#创建向量
v1 &lt;- c(1,2,3,4,5)#数值型向量
v1
```

```
## [1] 1 2 3 4 5
```

```r
v2 &lt;- c('apple','pear','banana','strawberry','lemon')#字符型向量
v2
```

```
## [1] "apple"      "pear"       "banana"     "strawberry" "lemon"
```

```r
v3 &lt;- c(T,F,F,T,T)#逻辑型向量
v3
```

```
## [1]  TRUE FALSE FALSE  TRUE  TRUE
```

```r
v4 &lt;- c(1:3)#数值型向量
v4
```

```
## [1] 1 2 3
```

---
# &lt;h1 lang="zh-CN"&gt;5.4 数据结构&lt;/h1&gt;

```r
#创建数据框(每个成分都是一个向量)
d1 &lt;- data.frame(v1,v2,v3)
d1
```

```
##   v1         v2    v3
## 1  1      apple  TRUE
## 2  2       pear FALSE
## 3  3     banana FALSE
## 4  4 strawberry  TRUE
## 5  5      lemon  TRUE
```

--
![error3](pic_new/chp5/error3.png)
--
&lt;font size = 5&gt; 
数据框每一列的元素数目要相同 &lt;br&gt;
---
# &lt;h1 lang="zh-CN"&gt;5.4 数据结构&lt;/h1&gt;

```r
#创建矩阵
m1 &lt;- matrix(c(1:9),nrow=3)
m1
```

```
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
```

```r
#创建三维数组
a1 &lt;- array(1:24,dim=c(3,4,2))
a1
```

```
## , , 1
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    4    7   10
## [2,]    2    5    8   11
## [3,]    3    6    9   12
## 
## , , 2
## 
##      [,1] [,2] [,3] [,4]
## [1,]   13   16   19   22
## [2,]   14   17   20   23
## [3,]   15   18   21   24
```
---
# &lt;h1 lang="zh-CN"&gt;5.4 数据结构&lt;/h1&gt;

```r
#创建列表
l1 &lt;- list(1,c('a','b'),c(T,F))
l1
```

```
## [[1]]
## [1] 1
## 
## [[2]]
## [1] "a" "b"
## 
## [[3]]
## [1]  TRUE FALSE
```

```r
l2 &lt;- list(d1,m1)
l2
```

```
## [[1]]
##   v1         v2    v3
## 1  1      apple  TRUE
## 2  2       pear FALSE
## 3  3     banana FALSE
## 4  4 strawberry  TRUE
## 5  5      lemon  TRUE
## 
## [[2]]
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
```

---
# &lt;h1 lang="zh-CN"&gt;5.4 数据结构&lt;/h1&gt;
数据可分为：定量数据（数值型）、定性数据（分类型）；定性数据又可分为名义型（无好坏顺序之分，如性别）、有序型（有好坏顺序之分，如疗效）。&lt;br&gt;
&lt;br&gt;
R 提供了因子这一数据结构（容器），专门用来存放名义型和有序型的分类变量。&lt;br&gt;
&lt;br&gt;
直接用字符向量也可以表示分类变量，但它只有字母顺序，不能规定想要的顺序，也不能表达有序分类变量。&lt;br&gt;
--

```r
x &lt;- c('good','better','best','bad','worse','worst')
sort(x)#排序
```

```
## [1] "bad"    "best"   "better" "good"   "worse"  "worst"
```
只会按照字母顺序排序
--

```r
x1 &lt;- factor(x,levels = c('best','better','good','bad','worse','worst'))
sort(x1)#排序
```

```
## [1] best   better good   bad    worse  worst 
## Levels: best better good bad worse worst
```
转化为因子之后可按照设置的方式排序
---
# &lt;h1 lang="zh-CN"&gt;5.4 数据结构&lt;/h1&gt;
## 索引&lt;br&gt;
--
&lt;font size = 5&gt;
-   数字索引&lt;/font&gt;  

```r
# 选取前 2 行以及前 3 列数据
penguin_data[1:2,1:3]
```

```
##    age ALEX1 ALEX2
## 1 1975     1     1
## 2 1995     2     2
```

```r
# 也可以使用减号
penguin_data[1:2,-c(4:ncol(penguin_data))]
```

```
##    age ALEX1 ALEX2
## 1 1975     1     1
## 2 1995     2     2
```
&lt;font size = 5&gt;
-   名称索引&lt;/font&gt;  

```r
# 同样选取前 2 行以及前 4 列数据
penguin_data[1:2,c('age','ALEX1','ALEX2')]
```

```
##    age ALEX1 ALEX2
## 1 1975     1     1
## 2 1995     2     2
```
---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
&lt;br&gt;
&lt;br&gt;
&lt;font size = 5&gt;
数学运算 &lt;br&gt;
&amp;emsp;+ - * / ^(加、减、乘、除、求幂)等 &lt;br&gt;
&lt;br&gt;
比较运算 &lt;br&gt;
&amp;emsp;&gt;、&lt;、&gt;=、&lt;=、==、!= &lt;br&gt;
&amp;emsp;identical(x,y) —— 判断两个对象是否严格相等 &lt;br&gt;
&lt;br&gt;
逻辑运算 &lt;br&gt;
&amp;emsp;| &amp; ! (或、与、非)等 &lt;br&gt;
---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 数学运算:+ - * / ^(加、减、乘、除、求幂)等

```r
3.14 + 2
```

```
## [1] 5.14
```
数值型可以进行数学运算
--

```r
TRUE * 3
```

```
## [1] 3
```

```r
F ^ 2
```

```
## [1] 0
```
逻辑型可以进行数学运算
--

```r
(3+1i)^2
```

```
## [1] 8+6i
```
复数型可以进行数学运算
--
![error5](pic_new/chp5/error5.png)
---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 数学运算:+ - * / ^(加、减、乘、除、求幂)等

```r
c(1:5) ^ 2
```

```
## [1]  1  4  9 16 25
```

```r
c(1:5) * c(6:10)
```

```
## [1]  6 14 24 36 50
```

```r
c(T,F) / c(T,T)
```

```
## [1] 1 0
```

```r
c(8+6i,7+4i) + c(3+2i,4+4i)
```

```
## [1] 11+8i 11+8i
```
![error6](pic_new/chp5/error6.png)
---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 比较运算:&gt;、&lt;、&gt;=、&lt;=、==、!= 
![bijiao](./pic_new/chp5/bijiao.png)
---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 比较运算:&gt;、&lt;、&gt;=、&lt;=、==、!= 

```r
3 &lt; 5
```

```
## [1] TRUE
```

```r
7.00 == 7
```

```
## [1] TRUE
```

```r
T == TRUE
```

```
## [1] TRUE
```

```r
T &gt; F
```

```
## [1] TRUE
```
数值型和逻辑型可以进行比较运算
---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 比较运算:&gt;、&lt;、&gt;=、&lt;=、==、!=

```r
(3+4i) != (3-4i)
```

```
## [1] TRUE
```

```r
(1+1i) == (1+3i) 
```

```
## [1] FALSE
```
![errorCom](./pic_new/chp5/errorCom.png)
复数型仅可以进行“==、!=”的比较运算
---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 比较运算:&gt;、&lt;、&gt;=、&lt;=、==、!=

```r
'a' == 'A'
```

```
## [1] FALSE
```

```r
'a' &lt;= 'b'
```

```
## [1] TRUE
```

```r
'abc'&gt;'a'
```

```
## [1] TRUE
```
字符型可以进行比较运算
---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 比较运算:&gt;、&lt;、&gt;=、&lt;=、==、!= 

```r
3 &lt; c(1:5)
```

```
## [1] FALSE FALSE FALSE  TRUE  TRUE
```

```r
c(1:3) &lt; c(4:6)
```

```
## [1] TRUE TRUE TRUE
```

```r
3 %in% c(1:5)
```

```
## [1] TRUE
```

```r
c(1:3) %in% c(3:5)
```

```
## [1] FALSE FALSE  TRUE
```

```r
c(T,F,T) != c(F,T,T)
```

```
## [1]  TRUE  TRUE FALSE
```
数值型和逻辑型向量可以进行比较运算。

---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 比较运算:&gt;、&lt;、&gt;=、&lt;=、==、!=

```r
'apple' %in% c('apple','pear','banana','strawberry','lemon')
```

```
## [1] TRUE
```

```r
c('apple', 'watermelon') %in% c('apple','pear','banana','strawberry','lemon')
```

```
## [1]  TRUE FALSE
```
字符型向量可以进行比较运算
---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 比较运算:&gt;、&lt;、&gt;=、&lt;=、==、!=
字符是否匹配的问题还可以具体为是否完全匹配、是否部分匹配&lt;br&gt;

```r
#完全匹配
'c' %in% c('abc','cd','c')
```

```
## [1] TRUE
```

```r
#部分匹配
grepl('c',c('abc','cd','c'))
```

```
## [1] TRUE TRUE TRUE
```

```r
#部分匹配之开头匹配
startsWith(c('abc','cd','c'),'c')
```

```
## [1] FALSE  TRUE  TRUE
```

```r
#部分匹配之结尾匹配
endsWith(c('abc','cd','c'),'c')
```

```
## [1]  TRUE FALSE  TRUE
```

---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 比较运算:&gt;、&lt;、&gt;=、&lt;=、==、!=

&lt;font size=5&gt;
什么是通配符？&lt;br&gt;
--
&amp;emsp;&amp;emsp;通配符是一种特殊字符，它可以在匹配文件名或其他文本字符串时代替其他字符。&lt;br&gt;
&lt;br&gt;
--
R中常使用的通配符包括"*""?"和"[]"。&lt;br&gt;
--
&amp;emsp;&amp;emsp;*：代表任意数量的字符，例如*.csv将匹配所有以.csv结尾的文件。&lt;br&gt;
&amp;emsp;&amp;emsp;?：代表单个字符，例如file?.txt将匹配file1.txt，file2.txt等文件，但不会匹配file10.txt。&lt;br&gt;
&amp;emsp;&amp;emsp;[]：用于匹配指定的一组字符。例如，file[123].txt将匹配file1.txt，file2.txt和file3.txt。
&lt;/font&gt;

---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
![table](pic_new/chp5/table.png)
---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 逻辑运算：| &amp; ! (或、与、非)等

```r
!1
```

```
## [1] FALSE
```

```r
!0
```

```
## [1] TRUE
```

```r
1 &amp; 0
```

```
## [1] FALSE
```

```r
11 | 0
```

```
## [1] TRUE
```

```r
T &amp; F
```

```
## [1] FALSE
```

```r
!T
```

```
## [1] FALSE
```

---
# &lt;h1 lang="zh-CN"&gt;5.5 对数据的操纵&lt;/h1&gt;
## 逻辑运算：| &amp; ! (或、与、非)等


```r
c(T,F,F) | T
```

```
## [1] TRUE TRUE TRUE
```

```r
c(T,F,F) | F
```

```
## [1]  TRUE FALSE FALSE
```

```r
c(T,F,F) &amp; c(T,T,F)
```

```
## [1]  TRUE FALSE FALSE
```

```r
c(1,2) &amp; c(0,1)
```

```
## [1] FALSE  TRUE
```

---
# &lt;h1 lang="zh-CN"&gt;5.6 数据类型的判断与转换&lt;/h1&gt;
## 数据类型的判断:is族函数


```r
is.numeric(1.0)#判断是否为数值型
```

```
## [1] TRUE
```

```r
is.numeric('a')
```

```
## [1] FALSE
```

```r
is.character(c('a','b'))#判断是否为字符型
```

```
## [1] TRUE
```

```r
is.complex(1+1i)#判断是否为复数型
```

```
## [1] TRUE
```

```r
is.null(NULL)#判断是否为null值
```

```
## [1] TRUE
```

```r
is.na(c(1,NA))#判断是否为NA值
```

```
## [1] FALSE  TRUE
```

---
# &lt;h1 lang="zh-CN"&gt;5.6 数据类型的判断与转换&lt;/h1&gt;
## 数据类型的转化:as族函数
&lt;font size = 5&gt; 转化为数值：as.numeric

```r
as.numeric(c('1','2','3'))
```

```
## [1] 1 2 3
```

```r
as.numeric(c('1','2','a'))
```

```
## Warning: NAs introduced by coercion
```

```
## [1]  1  2 NA
```

```r
as.numeric(c(T,F))
```

```
## [1] 1 0
```

---
# &lt;h1 lang="zh-CN"&gt;5.6 数据类型的判断与转换&lt;/h1&gt;
## 数据类型的转化
&lt;font size = 5&gt; 转化为字符串：as.character

```r
as.character(c(1,2,3))
```

```
## [1] "1" "2" "3"
```

```r
as.character(c(T,F))
```

```
## [1] "TRUE"  "FALSE"
```

```r
as.character(as.numeric(c('1','2','3')))
```

```
## [1] "1" "2" "3"
```

---
# &lt;h1 lang="zh-CN"&gt;5.6 数据类型的判断与转换&lt;/h1&gt;
## 数据类型的转化
&lt;font size = 5&gt; 转化为因子(factor)：factor&lt;br&gt;
R中用因子代表数据中分类变量, 如性别、省份、职业。


```r
class(penguin_data$sex)
```

```
## [1] "integer"
```

```r
unique(penguin_data$sex)
```

```
## [1]  1  2 NA  3
```

```r
sex1 &lt;- factor(penguin_data$sex,levels = c(1,2),labels = c('male','female'))
unique(sex1)
```

```
## [1] male   female &lt;NA&gt;  
## Levels: male female
```

---
# &lt;h1 lang="zh-CN"&gt;5.7 函数&lt;/h1&gt;
## 什么是函数
&lt;font size=5&gt;
&amp;emsp;&amp;emsp;sqrt()、getwd()、here()等都是R中的函数。
&lt;br&gt;
&amp;emsp;&amp;emsp;在R中，函数是一种用于执行特定任务或计算的代码块。函数接受输入参数，执行特定的操作，并返回结果。
&lt;/font&gt;
&lt;br&gt;
--
&lt;font size=5&gt;
已有函数&lt;br&gt;
&amp;emsp;&amp;emsp;R base; &lt;br&gt;
&amp;emsp;&amp;emsp;R packages; &lt;br&gt;
&amp;emsp;&amp;emsp;functions from other sources&lt;br&gt;
--
&lt;font size=5&gt;
自定义函数&lt;br&gt;
&amp;emsp;&amp;emsp;function()

```r
mysum &lt;- function(x,y){
  3*x+5*y
}
mysum(1,2)
```

```
## [1] 13
```

---
# &lt;h1 lang="zh-CN"&gt;5.7 函数&lt;/h1&gt;
## 函数求助
&lt;font size=5&gt;
&amp;emsp;&amp;emsp;如果我们不知道一个函数是什么，有什么用处。在R中，我们可以在Console中使用“?函数名”来打开帮助文档。
--
&lt;/font&gt;&lt;br&gt;
![help](./pic_new/chp5/help.png)
--
![help2](./pic_new/chp5/help2.png){:height="20px" width="80px"}

---
# &lt;h1 lang="zh-CN"&gt;5.7 函数&lt;/h1&gt;
## 如何调用函数
&lt;font size=5&gt;
-首先需要下载函数所在的R包（部分R包在下载R时已经自动下载）&lt;br&gt;
&amp;emsp;&amp;emsp;install.pcakages("R包名称")&lt;br&gt;
-然后需要加载R包&lt;br&gt;
&amp;emsp;&amp;emsp;library(R包名称)&lt;br&gt;
-已下载的R包，也可以直接 R包::函数名称 来调用函数&lt;br&gt;

-不同的R包中可能会有相同的函数名，为了避免调用错误，推荐使用：R包::函数名称&lt;br&gt;
---
# &lt;h1 lang="zh-CN"&gt;5.7 函数&lt;/h1&gt;
## 如何调用函数
![error4](./pic_new/chp5/error4.png)
&lt;font size = 5&gt;
未加载时不能直接调用函数
--

```r
here::here()#::左边的here指名为here的R包，::右边的here指这个包中名为here的函数
```

```
## [1] "D:/Study/NNU/YAN2/2/R/R4Psy"
```

```r
library(here)
```

```
## here() starts at D:/Study/NNU/YAN2/2/R/R4Psy
```

```r
here()
```

```
## [1] "D:/Study/NNU/YAN2/2/R/R4Psy"
```

---
# &lt;h1 lang="zh-CN"&gt;5.7 函数&lt;/h1&gt;
## 函数的使用：数据清理

- filter() 选择符合某个条件的行（可能代表被试） &lt;br&gt;

- mutate() 生成新的变量 &lt;br&gt;

- group_by() 依据某些变量产生的条件，给数据分组 &lt;br&gt;
  **如果你使用了 "group_by",** &lt;br&gt;
  **一定要在summarise后使用 "ungroup".** &lt;br&gt;
  
- summarise() 进行某些加减乘除的运算 &lt;br&gt;  

- ungroup() 取消刚刚进行的分组 &lt;br&gt;  

- select() 选择最终进行分析时需要用到的变量，同时也起到了为所有变量排序的功能 &lt;br&gt;

- arrange() 某一列的值，按照某个顺序排列（其他列也会随之变动） &lt;br&gt;

_清洗数据时，也基本上会按照这个顺序来使用_
---
# &lt;h1 lang="zh-CN"&gt;5.7 函数&lt;/h1&gt;
## 函数的使用：filter

```r
# 使用filter筛选出数据集中1995之后出生的被试
df.clean.filter &lt;- penguin_data %&gt;%
  dplyr::filter(.,age &gt;= 1995)#dplyr包中的filter函数
sort(unique(penguin_data$age))
```

```
##  [1] 1922 1940 1945 1948 1951 1952 1953 1955 1957 1958 1959 1960 1961 1962 1963
## [16] 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974 1975 1976 1977 1978
## [31] 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993
## [46] 1994 1995 1996 1997 1998
```

```r
sort(unique(df.clean.filter$age))#查看是否只有1995年之后出生的被试
```

```
## [1] 1995 1996 1997 1998
```

---
# &lt;h1 lang="zh-CN"&gt;5.7 函数&lt;/h1&gt;
## 函数的使用：mutate


```r
# 对所有含有ALEX的列求和
df.clean.mutate &lt;- penguin_data %&gt;% 
  dplyr::mutate(ALEX_SUM = rowSums(select(., starts_with("ALEX"))))#筛选以"ALEX"开头的列
```


```r
DT::datatable(head(df.clean.mutate, 10),
              fillContainer = TRUE, options = list(pageLength = 3))
```

<div id="htmlwidget-326afc91dd5a5febab44" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-326afc91dd5a5febab44">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6","7","8","9","10"],[1975,1995,1995,1988,1991,1995,1996,1973,1996,1996],[1,2,4,2,2,2,1,3,2,3],[1,2,1,3,1,3,1,3,3,3],[1,2,1,4,1,1,1,2,1,1],[2,2,2,5,5,3,1,3,3,2],[2,2,4,3,2,2,4,4,2,4],[1,2,1,4,2,1,1,4,2,1],[2,2,4,2,3,1,2,4,2,2],[2,2,1,4,4,2,1,4,2,4],[4,4,1,4,1,1,4,4,2,4],[1,2,2,3,1,2,2,5,2,1],[1,2,1,2,2,1,1,3,1,4],[2,2,1,2,1,2,2,2,2,1],[4,2,2,4,2,3,4,2,2,2],[3,2,1,2,4,4,3,3,4,3],[4,3,1,4,4,5,5,4,3,5],[2,2,1,3,2,4,5,1,2,4],[3.72222222222222,4.05555555555556,1.44444444444444,4.72222222222222,2.11111111111111,2,2.55555555555556,3.05555555555556,3.55555555555556,4.38888888888889],[6,0,0,2,0,0,null,0,0,0],[3.11111111111111,4.88888888888889,1.33333333333333,3.88888888888889,4.66666666666667,3.33333333333333,3.11111111111111,3.55555555555556,3.33333333333333,3.22222222222222],[3.44444444444444,2,2,3,1.77777777777778,2.44444444444444,3.77777777777778,3.33333333333333,1.88888888888889,4.22222222222222],[89,89,89,89,89,89,89,89,89,89],[3.27777777777778,3,1.61111111111111,3.94444444444444,4.94444444444444,3.77777777777778,6.44444444444444,3.22222222222222,4,5.27777777777778],[15,null,null,null,null,null,null,10,null,1],[1.63636363636364,2.18181818181818,2,3.27272727272727,2.18181818181818,1.72727272727273,1.72727272727273,3.54545454545455,2,2.63636363636364],[1,1,1,2,1,1,1,1,1,1],[5,6,1,3,1,1,2,3,4,5],[5,4,1,6,1,1,1,2,4,6],[3,2,1,6,1,1,4,3,4,6],[5,5,1,5,1,2,1,2,4,5],[5,5,1,4,1,2,4,3,4,4],[3,2,1,4,5,1,1,3,1,3],[1,3,1,3,2,1,2,3,4,5],[6,5,1,3,1,2,7,3,4,7],[5,2,1,4,7,6,1,3,4,3],[2,3,1,4,1,2,4,1,4,3],[6,7,1,6,6,2,2,5,2,6],[3,4,1,5,1,2,1,2,4,4],[3,3,1,6,2,4,2,5,4,4],[2,3,7,5,1,1,1,4,1,2],[3,4,1,5,2,2,1,5,4,1],[3,5,3,5,1,1,2,3,4,4],[6,5,1,6,2,3,6,3,4,7],[1,5,1,5,2,2,4,2,4,4],[2,3,2,5,1,5,7,3,4,5],[2,4,2,5,7,5,1,2,4,7],[5,3,2,5,2,4,6,4,4,5],[3,2,2,4,5,4,7,3,4,5],[3,2,2,3,2,3,7,3,4,6],[2,3,1,4,4,4,7,3,4,5],[5,3,1,6,2,3,7,4,4,6],[5,4,1,3,6,3,7,4,4,7],[3,5,1,3,7,1,7,4,4,7],[2,3,1,4,6,3,6,3,4,4],[4,2,2,5,6,6,6,3,4,4],[2,2,2,3,6,5,7,2,4,5],[3,4,1,4,7,4,7,2,4,3],[3,2,2,5,2,3,7,3,4,6],[4,3,3,3,7,4,6,3,4,5],[5,3,1,2,6,5,7,4,4,6],[4,3,1,3,6,3,7,6,4,5],[2,3,2,4,7,3,7,2,4,4],["9:23:38","9:23:26","8:57:08","8:55:14","8:54:35","8:39:12","8:32:08","8:28:57","8:28:03","8:25:57"],[3,2.2,1.2,3,2.6,3.6,3.8,2.4,2.6,3],[2,2,2,2,2,2,2,2,2,2],[0,0,12,0,5,0,null,1,0,2],[4,4,4,3,4,4,4,1,3,3],[4,5,1,5,5,4,5,3,3,4],[3,5,1,4,5,4,2,3,3,5],[4,5,4,5,5,4,4,2,4,3],[3,5,1,5,5,4,5,4,5,3],[3,5,1,4,4,4,2,3,4,4],[2,4,1,2,5,2,1,4,3,2],[4,5,1,2,4,2,5,5,2,2],[3,5,1,4,4,3,1,4,3,3],[2,5,1,4,5,3,3,4,3,3],[4,1,5,5,1,3,2,3,3,4],[4,2,6,4,1,3,2,3,3,5],[5,6,5,3,3,3,2,2,2,1],[4,2,4,1,2,2,2,2,1,3],[4,3,3,2,2,2,2,2,3,2],[1,2,1,2,2,4,2,3,3,3],[2,2,1,2,1,4,2,3,1,2],[17,28,24,19,29,33,53,17,17,19],[4.33333333333333,6.5,6.83333333333333,3.5,1.5,2,5.83333333333333,6.33333333333333,5.66666666666667,5.16666666666667],[2.27272727272727,2.63636363636364,2.18181818181818,2,1.90909090909091,2.45454545454545,2.81818181818182,2.54545454545455,1.81818181818182,3.90909090909091],[2,3,3,1,3,4,4,2,2,5],[2,2,4,1,2,4,4,3,3,4],[2,3,2,2,1,2,2,3,2,5],[4,3,4,3,4,4,2,2,2,4],[2,3,1,2,1,3,3,3,2,3],[2,2,1,2,1,1,2,2,1,3],[2,2,1,2,1,2,2,4,2,4],[2,3,3,1,1,1,2,3,2,3],[3,3,3,2,2,2,4,2,1,3],[2,3,1,4,2,1,2,1,1,4],[2,2,1,2,3,3,4,3,2,5],[4,2,1,2,2,3,3,3,3,4],[4,2,4,4,1,3,4,4,2,4],[2,2,1,3,1,2,5,3,1,2],[5,2,4,2,1,3,4,3,4,4],[2,2,1,3,1,2,1,2,3,5],[2,2,1,2,3,2,3,4,1,4],[4,2,1,3,2,2,5,3,1,5],[4,2,1,4,1,3,5,4,1,5],[4,2,4,4,4,2,4,4,1,5],[2,2,1,1,2,2,2,2,2,2],[2,4,2,4,3,5,2,1,3,3],[2,4,3,2,5,5,4,4,3,4],[2,4,3,1,5,5,2,5,5,5],[1,4,2,1,3,2,2,2,5,1],[1,4,4,2,5,3,1,2,5,2],[4,3,2,1,5,4,3,3,3,1],[2,4,4,2,5,3,2,3,4,2],[2,2,1,3,4,3,2,2,5,4],[5,4,3,4,4,5,4,4,3,3],[4,3,5,3,3,5,5,3,4,2],[3,4,4,2,4,5,3,2,2,5],[5,5,4,2,4,4,1,3,4,3],[4,4,4,2,4,3,2,2,2,2],[2.84615384615385,3.76923076923077,3.15384615384615,2.23076923076923,4.15384615384615,4,2.53846153846154,2.76923076923077,3.69230769230769,2.84615384615385],[1,1,1,2,1,1,2,1,1,2],[1,2,2,2,2,2,2,1,2,1],[2,1,1,1,2,2,2,4,2,2],[1,1,1,1,1,1,1,1,1,1],[null,null,null,null,null,null,null,null,null,null],[4,4,4,4,2,4,4,4,4,4],[4,4,4,4,2,4,4,2,4,4],[5,1,4,5,5,5,5,5,5,5],[null,null,4,null,null,null,null,null,null,null],[1,8,2,1,8,2,3,8,2,6],[null,6,2,null,5,1,2,3,2,3],[6,4,5,5,7,5,8,4,3,8],[3,1,5,1,3,5,8,4,2,8],[1,1,1,1,2,1,1,1,1,1],[null,null,null,null,8,null,null,null,null,null],[1,2,2,1,1,2,2,2,2,2],[null,8,8,null,null,8,8,8,8,8],[3,3,2,3,3,1,1,1,1,1],[2,8,1,8,1,null,null,null,null,null],[6,5,6,4,8,null,null,null,null,null],[1,3,1,1,1,8,6,4,1,3],[1,1,1,1,1,1,1,2,1,1],[null,null,null,null,null,null,null,2,null,null],[1,1,1,2,1,2,2,2,2,1],["","","","","","Rowing Club","University Friends","ODAA","Oxford Latin Speaking Society",""],["","","","","","Rugby Club","Business Social","","Oxford Latin Conversation Society",""],["","","","","","","Lecturers/ Advisors","","Plato Reading Group",""],["","","","","","","Friends from home","","",""],["","","","","","","Neighbors","","",""],[null,null,null,null,null,7,20,1,2,null],[null,null,null,null,null,7,15,null,4,null],[null,null,null,null,null,null,5,null,1,null],[null,null,null,null,null,null,9,null,null,null],[null,null,null,null,null,null,6,null,null,null],[6,6,7,2,1,1,6,6,7,7],[5,7,7,5,2,2,7,6,7,4],[5,6,7,3,2,3,5,7,6,5],[3,7,7,4,1,2,5,6,6,5],[2,6,7,5,2,2,6,7,5,5],[5,7,6,2,1,2,6,6,3,5],[4,6,6,4,1,2,5,6,3,4],[5,7,8,5,7,6,null,7,6,6],[1,2,3,1,2,4,null,2,2,3],[4,2,4,4,1,2,2,3,3,1],[4,4,5,2,1,4,4,2,5,4],[4,3,4,3,1,4,2,3,4,4],[5,3,4,3,4,4,4,4,2,4],[2,3,4,4,4,4,5,2,2,3],[2,4,4,3,1,3,4,3,1,3],[2,5,4,3,3,4,5,4,2,2],[2,2,4,3,4,3,5,3,2,4],[4,5,5,2,1,2,4,2,4,5],[2,3,2,2,1,4,1,4,4,5],[2,2,1,2,1,2,2,2,2,1],[1,2,2,2,4,4,4,2,2,2],[4,4,4,3,4,2,2,3,2,1],[5,4,2,3,2,4,3,4,4,4],[4,4,2,3,3,1,2,4,5,3],[2,3,4,4,4,5,5,4,4,4],[2,3,5,4,4,3,2,4,2,2],[4,3,4,2,4,3,4,3,3,2],[3,3,5,2,4,4,4,4,3,3],[2,3,1,3,5,4,1,3,2,4],[4,3,4,2,4,4,5,4,3,5],[3,3,5,4,4,3,2,2,3,3],[2,3,1,3,4,3,2,3,4,3],[3,3,1,4,1,2,2,2,3,3],[4,3,5,3,1,2,5,1,4,4],[3,3,3,2,1,3,3,2,3,3],[4,3,1,4,4,4,2,4,1,1],[4,5,4,2,1,3,1,4,4,5],[3,5,4,4,1,2,1,3,5,5],[3,2,2,4,4,2,5,2,2,4],[2,4,2,5,1,2,1,3,2,4],[4,3,1,2,4,2,5,1,1,4],[4,3,2,2,3,3,1,4,3,4],[1,4,3,4,4,2,1,3,2,2],[2,4,2,3,5,4,2,5,1,4],[2,4,2,4,5,4,4,4,2,4],[4,4,4,3,4,4,2,4,2,4],[3,4,2,4,4,4,4,5,5,1],[4,2,2,3,4,4,5,2,2,4],[5,3,3,2,4,2,2,2,2,4],[4,3,2,3,3,3,2,1,2,4],[4,3,5,2,4,4,4,4,4,4],[1,4,2,3,4,2,2,3,2,3],[1,2,2,4,4,2,1,2,1,2],[4,3,2,3,1,2,1,4,4,2],[4,4,4,2,1,4,1,4,3,3],[3,3,4,3,4,2,4,3,3,4],[1,2,5,4,4,2,1,2,1,2],[2,3,5,4,4,2,1,2,1,2],[4,3,5,4,4,4,3,3,3,4],[4,4,2,5,1,3,5,2,4,5],[2,4,5,3,1,2,5,4,2,4],[2,4,4,3,4,2,1,3,2,2],[4,3,4,3,5,2,4,4,2,4],[2,4,2,2,4,3,3,2,2,4],[2,4,1,2,4,2,2,2,2,2],[1,2,5,4,1,1,4,2,2,2],[3.07692307692308,2.46153846153846,2.38461538461538,2.84615384615385,2.53846153846154,2.07692307692308,1.53846153846154,3,2.61538461538462,3.15384615384615],[4,2,3,3,3,2,1,4,5,3],[2,3,3,3,4,2,2,3,2,4],[4,3,4,4,3,3,1,3,3,5],[4,3,1,2,2,2,2,3,2,4],[4,2,2,3,2,2,2,3,2,3],[3,2,1,2,1,2,2,3,2,1],[4,2,2,3,3,2,1,4,2,3],[3,2,2,2,2,2,1,4,3,4],[3,2,3,3,2,2,2,1,2,3],[2,3,3,3,3,2,1,3,4,3],[4,2,3,4,3,2,2,2,1,2],[3,4,4,3,5,4,4,4,5,4],[2,4,2,3,2,2,2,3,3,2],[1,2,2,2,3,2,1,3,3,4],[34.9,35.8,34,36.9,35.3,34.7,36,36.5,34.7,35.9],[35.9,36,36.2,37,36.1,36.4,36.3,36.6,36.3,36.3],[2,2,2,2,4,4,2,2,2,2],[35.4,35.9,35.1,36.95,35.7,35.55,36.15,36.55,35.5,36.1],[1,1,1,1,1,1,1,1,1,1],[-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667],[5,5,5,5,5,5,5,5,5,5],[1,1,1,1,1,1,1,1,1,1],[0.186319647739787,0.472682850177291,-1.77049556891649,1.0454092550523,-1.19776916404149,-1.29322356485399,-0.815951560791479,-0.386406757135223,0.0431380465210342,0.759046052614796],[-0.00190690952064737,-0.249805147204807,-1.48929633562561,0.593048860921336,1.48548251658431,0.44430991831084,2.82413300007877,-0.0514865570574791,0.642628508458168,1.7829604018053],["Oxford","Oxford","Oxford","Oxford","Oxford","Oxford","Oxford","Oxford","Oxford","Oxford"],[33,35,28,51,37,37,38,51,35,44]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>ALEX1<\/th>\n      <th>ALEX2<\/th>\n      <th>ALEX3<\/th>\n      <th>ALEX4<\/th>\n      <th>ALEX5<\/th>\n      <th>ALEX6<\/th>\n      <th>ALEX7<\/th>\n      <th>ALEX8<\/th>\n      <th>ALEX9<\/th>\n      <th>ALEX10<\/th>\n      <th>ALEX11<\/th>\n      <th>ALEX12<\/th>\n      <th>ALEX13<\/th>\n      <th>ALEX14<\/th>\n      <th>ALEX15<\/th>\n      <th>ALEX16<\/th>\n      <th>anxiety<\/th>\n      <th>artgluctot<\/th>\n      <th>attachhome<\/th>\n      <th>attachphone<\/th>\n      <th>AvgHumidity<\/th>\n      <th>avoidance<\/th>\n      <th>cigs<\/th>\n      <th>DIDF<\/th>\n      <th>eatdrink<\/th>\n      <th>ECR1<\/th>\n      <th>ECR2<\/th>\n      <th>ECR3<\/th>\n      <th>ECR4<\/th>\n      <th>ECR5<\/th>\n      <th>ECR6<\/th>\n      <th>ECR7<\/th>\n      <th>ECR8<\/th>\n      <th>ECR9<\/th>\n      <th>ECR10<\/th>\n      <th>ECR11<\/th>\n      <th>ECR12<\/th>\n      <th>ECR13<\/th>\n      <th>ECR14<\/th>\n      <th>ECR15<\/th>\n      <th>ECR16<\/th>\n      <th>ECR17<\/th>\n      <th>ECR18<\/th>\n      <th>ECR19<\/th>\n      <th>ECR20<\/th>\n      <th>ECR21<\/th>\n      <th>ECR22<\/th>\n      <th>ECR23<\/th>\n      <th>ECR24<\/th>\n      <th>ECR25<\/th>\n      <th>ECR26<\/th>\n      <th>ECR27<\/th>\n      <th>ECR28<\/th>\n      <th>ECR29<\/th>\n      <th>ECR30<\/th>\n      <th>ECR31<\/th>\n      <th>ECR32<\/th>\n      <th>ECR33<\/th>\n      <th>ECR34<\/th>\n      <th>ECR35<\/th>\n      <th>ECR36<\/th>\n      <th>endtime<\/th>\n      <th>EOT<\/th>\n      <th>exercise<\/th>\n      <th>gluctot<\/th>\n      <th>health<\/th>\n      <th>HOME1<\/th>\n      <th>HOME2<\/th>\n      <th>HOME3<\/th>\n      <th>HOME4<\/th>\n      <th>HOME5<\/th>\n      <th>HOME6<\/th>\n      <th>HOME7<\/th>\n      <th>HOME8<\/th>\n      <th>HOME9<\/th>\n      <th>KAMF1<\/th>\n      <th>KAMF2<\/th>\n      <th>KAMF3<\/th>\n      <th>KAMF4<\/th>\n      <th>KAMF5<\/th>\n      <th>KAMF6<\/th>\n      <th>KAMF7<\/th>\n      <th>networksize<\/th>\n      <th>nostalgia<\/th>\n      <th>onlineid<\/th>\n      <th>onlineid1<\/th>\n      <th>onlineid2<\/th>\n      <th>onlineid3<\/th>\n      <th>onlineid4<\/th>\n      <th>onlineid5<\/th>\n      <th>onlineid6<\/th>\n      <th>onlineid7<\/th>\n      <th>onlineid8<\/th>\n      <th>onlineid9<\/th>\n      <th>onlineid10<\/th>\n      <th>onlineide11<\/th>\n      <th>phone1<\/th>\n      <th>phone2<\/th>\n      <th>phone3<\/th>\n      <th>phone4<\/th>\n      <th>phone5<\/th>\n      <th>phone6<\/th>\n      <th>phone7<\/th>\n      <th>phone8<\/th>\n      <th>phone9<\/th>\n      <th>romantic<\/th>\n      <th>scontrol1<\/th>\n      <th>scontrol2<\/th>\n      <th>scontrol3<\/th>\n      <th>scontrol4<\/th>\n      <th>scontrol5<\/th>\n      <th>scontrol6<\/th>\n      <th>scontrol7<\/th>\n      <th>scontrol8<\/th>\n      <th>scontrol9<\/th>\n      <th>scontrol10<\/th>\n      <th>scontrol11<\/th>\n      <th>scontrol12<\/th>\n      <th>scontrol13<\/th>\n      <th>selfcontrol<\/th>\n      <th>sex<\/th>\n      <th>smoke<\/th>\n      <th>SNI1<\/th>\n      <th>SNI2<\/th>\n      <th>SNI3<\/th>\n      <th>SNI4<\/th>\n      <th>SNI5<\/th>\n      <th>SNI6<\/th>\n      <th>SNI7<\/th>\n      <th>SNI8<\/th>\n      <th>SNI9<\/th>\n      <th>SNI10<\/th>\n      <th>SNI11<\/th>\n      <th>SNI12<\/th>\n      <th>SNI13<\/th>\n      <th>SNI14<\/th>\n      <th>SNI15<\/th>\n      <th>SNI16<\/th>\n      <th>SNI17<\/th>\n      <th>SNI18<\/th>\n      <th>SNI19<\/th>\n      <th>SNI20<\/th>\n      <th>SNI21<\/th>\n      <th>SNI22<\/th>\n      <th>SNI23<\/th>\n      <th>SNI24<\/th>\n      <th>SNI25<\/th>\n      <th>SNI26<\/th>\n      <th>SNI27<\/th>\n      <th>SNI28<\/th>\n      <th>SNI29<\/th>\n      <th>SNI30<\/th>\n      <th>SNI31<\/th>\n      <th>SNI32<\/th>\n      <th>SNS1<\/th>\n      <th>SNS2<\/th>\n      <th>SNS3<\/th>\n      <th>SNS4<\/th>\n      <th>SNS5<\/th>\n      <th>SNS6<\/th>\n      <th>SNS7<\/th>\n      <th>socialdiversity<\/th>\n      <th>socialembedded<\/th>\n      <th>STRAQ_1<\/th>\n      <th>STRAQ_2<\/th>\n      <th>STRAQ_3<\/th>\n      <th>STRAQ_4<\/th>\n      <th>STRAQ_6<\/th>\n      <th>STRAQ_7<\/th>\n      <th>STRAQ_8<\/th>\n      <th>STRAQ_9<\/th>\n      <th>STRAQ_10<\/th>\n      <th>STRAQ_11<\/th>\n      <th>STRAQ_12<\/th>\n      <th>STRAQ_19<\/th>\n      <th>STRAQ_20<\/th>\n      <th>STRAQ_21<\/th>\n      <th>STRAQ_22<\/th>\n      <th>STRAQ_23<\/th>\n      <th>STRAQ_24<\/th>\n      <th>STRAQ_25<\/th>\n      <th>STRAQ_26<\/th>\n      <th>STRAQ_27<\/th>\n      <th>STRAQ_28<\/th>\n      <th>STRAQ_29<\/th>\n      <th>STRAQ_30<\/th>\n      <th>STRAQ_31<\/th>\n      <th>STRAQ_32<\/th>\n      <th>STRAQ_33<\/th>\n      <th>STRAQ_5<\/th>\n      <th>STRAQ_13<\/th>\n      <th>STRAQ_14<\/th>\n      <th>STRAQ_15<\/th>\n      <th>STRAQ_16<\/th>\n      <th>STRAQ_17<\/th>\n      <th>STRAQ_18<\/th>\n      <th>STRAQ_34<\/th>\n      <th>STRAQ_35<\/th>\n      <th>STRAQ_36<\/th>\n      <th>STRAQ_37<\/th>\n      <th>STRAQ_38<\/th>\n      <th>STRAQ_39<\/th>\n      <th>STRAQ_40<\/th>\n      <th>STRAQ_41<\/th>\n      <th>STRAQ_42<\/th>\n      <th>STRAQ_43<\/th>\n      <th>STRAQ_44<\/th>\n      <th>STRAQ_45<\/th>\n      <th>STRAQ_46<\/th>\n      <th>STRAQ_47<\/th>\n      <th>STRAQ_48<\/th>\n      <th>STRAQ_49<\/th>\n      <th>STRAQ_50<\/th>\n      <th>STRAQ_51<\/th>\n      <th>STRAQ_52<\/th>\n      <th>STRAQ_53<\/th>\n      <th>STRAQ_54<\/th>\n      <th>STRAQ_55<\/th>\n      <th>STRAQ_56<\/th>\n      <th>STRAQ_57<\/th>\n      <th>stress<\/th>\n      <th>stress1<\/th>\n      <th>stress2<\/th>\n      <th>stress3<\/th>\n      <th>stress4<\/th>\n      <th>stress5<\/th>\n      <th>stress6<\/th>\n      <th>stress7<\/th>\n      <th>stress8<\/th>\n      <th>stress9<\/th>\n      <th>stress10<\/th>\n      <th>stress11<\/th>\n      <th>stress12<\/th>\n      <th>stress13<\/th>\n      <th>stress14<\/th>\n      <th>Temperature_t1<\/th>\n      <th>Temperature_t2<\/th>\n      <th>thermotype<\/th>\n      <th>avgtemp<\/th>\n      <th>filter_$<\/th>\n      <th>mintemp<\/th>\n      <th>language<\/th>\n      <th>langfamily<\/th>\n      <th>Zanxiety<\/th>\n      <th>Zavoidance<\/th>\n      <th>Site<\/th>\n      <th>ALEX_SUM<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":3,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,248]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[3,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
# &lt;h1 lang="zh-CN"&gt;5.7 函数&lt;/h1&gt;
## 函数的使用：select


```r
# 使用select选择age和ALEX的所有题目
df.clean.select &lt;- penguin_data %&gt;%
  dplyr::select(age, starts_with("ALEX"))
#笨一点的方法，就是把16个ALEX都写出来
```

<div id="htmlwidget-abd57d7fd396adf1698a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-abd57d7fd396adf1698a">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6","7","8","9","10"],[1975,1995,1995,1988,1991,1995,1996,1973,1996,1996],[1,2,4,2,2,2,1,3,2,3],[1,2,1,3,1,3,1,3,3,3],[1,2,1,4,1,1,1,2,1,1],[2,2,2,5,5,3,1,3,3,2],[2,2,4,3,2,2,4,4,2,4],[1,2,1,4,2,1,1,4,2,1],[2,2,4,2,3,1,2,4,2,2],[2,2,1,4,4,2,1,4,2,4],[4,4,1,4,1,1,4,4,2,4],[1,2,2,3,1,2,2,5,2,1],[1,2,1,2,2,1,1,3,1,4],[2,2,1,2,1,2,2,2,2,1],[4,2,2,4,2,3,4,2,2,2],[3,2,1,2,4,4,3,3,4,3],[4,3,1,4,4,5,5,4,3,5],[2,2,1,3,2,4,5,1,2,4]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>ALEX1<\/th>\n      <th>ALEX2<\/th>\n      <th>ALEX3<\/th>\n      <th>ALEX4<\/th>\n      <th>ALEX5<\/th>\n      <th>ALEX6<\/th>\n      <th>ALEX7<\/th>\n      <th>ALEX8<\/th>\n      <th>ALEX9<\/th>\n      <th>ALEX10<\/th>\n      <th>ALEX11<\/th>\n      <th>ALEX12<\/th>\n      <th>ALEX13<\/th>\n      <th>ALEX14<\/th>\n      <th>ALEX15<\/th>\n      <th>ALEX16<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":3,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[3,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
# &lt;h1 lang="zh-CN"&gt;5.7 函数&lt;/h1&gt;
## 函数的使用：group_by()

```r
df.clean.group_by &lt;- penguin_data %&gt;%
  dplyr::group_by(.,Site) %&gt;% # 根据被试所在地区将数据拆分
  dplyr::summarise(mean_avoidance = mean(avoidance)) %&gt;% # 计算不同地区被试的平均avoidance
  dplyr::ungroup()
```

<div id="htmlwidget-e81ab5dd452bd37cf1ed" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e81ab5dd452bd37cf1ed">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4"],["Bamberg","Chile","Kassel","METU"],[null,null,null,2.80294659300184]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Site<\/th>\n      <th>mean_avoidance<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[4,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
# &lt;h1 lang="zh-CN"&gt;5.7 函数&lt;/h1&gt;
## &lt;h2 lang="zh-CN"&gt;把之前学到的函数一起使用&lt;/h2&gt;

```r
df.pg.clean &lt;- penguin_data %&gt;%
  dplyr::filter(eatdrink == 1) %&gt;% # 选择eatdrink为1的被试
  dplyr::select(age, starts_with("ALEX"), eatdrink, avoidance) %&gt;%
  dplyr::mutate(ALEX1 = case_when(ALEX1 == '1' ~ '5', # 反向计分
                                  ALEX1 == '2' ~ '4',
                                  ALEX1 == '3' ~ '3',
                                  ALEX1 == '4' ~ '2',
                                  ALEX1 == '5' ~ '1',
                                  TRUE ~ as.character(ALEX1))) %&gt;%
  dplyr::mutate(ALEX1 = as.numeric(ALEX1)) %&gt;%
  dplyr::mutate(ALEX_SUM = rowSums(select(., starts_with("ALEX"))), # 把所有ALEX的题目分数求和
                decade = case_when(age &lt;= 1969 ~ 60, # 把出生年份转换为年代
                                   age &gt;= 1970 &amp; age &lt;= 1979 ~ 70,
                                   age &gt;= 1980 &amp; age &lt;= 1989 ~ 80,
                                   age &gt;= 1990 &amp; age &lt;= 1999 ~ 90,
                                   TRUE ~ NA_real_)) %&gt;%
  dplyr::group_by(decade) %&gt;% # 按照年代将数据拆分
  dplyr::summarise(mean_ALEX = mean(ALEX_SUM)) %&gt;% # 计算每个年代的被试的平均的ALEX_SUM
  dplyr::ungroup() # 解除对数据的拆分
```
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
